# colors
set -g default-terminal "tmux-256color"
set -as terminal-features ",*:RGB"

# undercurl support
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'

# underscore colours - needs tmux-3.0
set -as terminal-overrides ',*:Setulc=\E[58::2::::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'

# xterm keys options
set-option -g extended-keys on
set -as terminal-features 'xterm*:extkeys'


set -g monitor-activity off
set -g visual-activity off

set -g pane-border-lines single
set -g pane-border-indicators colour
set-option -g focus-events on
set-hook -g pane-focus-in 'select-pane -P "bg=#0D1116,fg=white"'
set-hook -g pane-focus-out 'select-pane -P "bg=#1c242f,fg=default"'

unbind C-b
set-option -g prefix C-a
bind-key C-a send-prefix

# reload config file
bind R source-file ~/.config/tmux/tmux.conf \; display 'config reloaded'

# mouse mode
set -g mouse on

# don't rename windows automatically
set-option -g allow-rename off

# renumber windows when a window is closed
set -g renumber-windows on

# start windows and panes at 1
set -g base-index 1
setw -g pane-base-index 1

# better colors
# set  -g default-terminal "screen-256color"
# set -ag terminal-overrides ",xterm-256color:RGB"
# tmux_conf_theme_24b_colour=tru|

# hook for resizing panes on client resize
set-hook -g client-resized resize-pane

# no confirm before kill pane/window
bind-key w kill-pane

bind-key - splitw -v -c "#{pane_current_path}"

# new window
bind-key t new-window
bind-key N command-prompt -p "New Session:" "new-session -A -s '%%'"
bind-key X confirm kill-session

# change to last session
bind-key -n M-l switch-client -l

# Switch ? and /
bind-key / list-keys -N
bind-key ? command-prompt -k -p key { list-keys -1N "%%" }

# pane movement with smart-splits.nvim
bind-key -n C-Left if -F "#{@pane-is-vim}" 'send-keys C-Left'  'select-pane -L'
bind-key -n C-Right if -F "#{@pane-is-vim}" 'send-keys C-Right'  'select-pane -R'
bind-key -n C-Up if -F "#{@pane-is-vim}" 'send-keys C-Up'  'select-pane -U'
bind-key -n C-Down if -F "#{@pane-is-vim}" 'send-keys C-Down'  'select-pane -D'


set-window-option -g mode-keys vi

bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "clip.exe"
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-selection "clip.exe"
bind -T copy-mode-vi MouseDown1Pane send-keys -X clear-selection
bind -T copy-mode-vi Escape send-keys -X cancel

bind r command-prompt -p "Command:" "display-popup -w 90% -h 90% -E %%"

bind P paste-buffer

# Allows for faster key repetition
set -s escape-time 10

# tmux messages are displayed for 2 seconds
set -g display-time 2000

# Activity monitoring
setw -g monitor-activity on
set -g visual-activity on

# increase scrollback buffer size
set -g history-limit 50000

set -g @tokyo-night-tmux_window_id_style none
set -g @tokyo-night-tmux_pane_id_style hide
set -g @tokyo-night-tmux_zoom_id_style dsquare
set -g @tokyo-night-tmux_time_format 12H
set -g status-position top 

##################################
### DESIGN #######################
##################################
thm_bg="#1e1e28"
thm_fg="#dadae8"
# thm_cyan="#00BBBB"
thm_cyan="#c2e7f0"
thm_black="#15121c"
thm_gray="#332e41"
thm_magenta="#c6aae8"
thm_pink="#e5b4e2"
thm_red="#e38c8f"
thm_green="#b1e3ad"
thm_yellow="#ebddaa"
thm_blue="#a4b9ef"
thm_orange="#f9c096"

thm_vibrant_green="#3ece33"
thm_vibrant_black="#575268"

if "test ! -d ~/.config/tmux/plugins/tpm" \
   "run 'git clone https://github.com/tmux-plugins/tpm ~/.config/tmux/plugins/tpm && ~/.config/tmux/plugins/tpm/bin/install_plugins'"

set -g @plugin 'tmux-plugins/tpm'
# set -g @plugin 'tmux-plugins/tmux-resurrect'
# set -g @resurrect-capture-pane-contents 'on'
# set -g @plugin 'tmux-plugins/tmux-continuum'
# set -g @continuum-restore 'on'
# set -g @continuum-save-interval '5'
set -g @plugin 'kenos1/tmux-cht-sh'
set -g @plugin 'b0o/tmux-autoreload'
set -g @plugin 'tardunge/kmux-status' # need to configure
set -g @plugin 'nhdaly/tmux-better-mouse-mode'
set -g @plugin 'janoamaral/tokyo-night-tmux'

run '$XDG_CONFIG_HOME/tmux/plugins/tpm/tpm'

# ----------------------------=== Theme ===--------------------------
# status
# set -g status "on"
# set -g status-bg "black"
# set -g status-justify "left"
# set -g status-left-length "100"
# set -g status-right-length "100"
#
#
# # panes
# set -g pane-border-style fg="${thm_gray}"
# set -g pane-active-border-style fg="${thm_blue}"
#
# # windows
# setw -g window-status-activity-style fg="${thm_fg}",bg="${thm_bg}",none
# setw -g window-status-style fg="${thm_fg}",bg="${thm_bg}",none
# setw -g window-status-separator " "
#
# # --------=== Statusline
# set -g status-left "#{?client_prefix,#[bg=$thm_red],#[bg=$thm_cyan]}#[fg=$thm_bg] #S "
# set -g status-right "#[fg=$thm_yellow,nobold,nounderscore,noitalics] ó°¸˜ #[fg=$thm_fg,bg=black] %d/%m #(date +%%H:%%M) "
# set -g status-position top


